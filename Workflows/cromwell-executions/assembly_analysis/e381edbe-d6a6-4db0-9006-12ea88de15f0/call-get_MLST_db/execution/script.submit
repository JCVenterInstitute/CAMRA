#!/bin/bash
# make sure there is no preexisting Docker CID file
rm -f /Users/dmatute/Documents/CAMRA/Scripts/Terra_Tool_Creation/GitHub/CAMRA/Workflows/cromwell-executions/assembly_analysis/e381edbe-d6a6-4db0-9006-12ea88de15f0/call-get_MLST_db/execution/docker_cid
# run as in the original configuration without --rm flag (will remove later)
docker run \
  --cidfile /Users/dmatute/Documents/CAMRA/Scripts/Terra_Tool_Creation/GitHub/CAMRA/Workflows/cromwell-executions/assembly_analysis/e381edbe-d6a6-4db0-9006-12ea88de15f0/call-get_MLST_db/execution/docker_cid \
  -i \
   \
  --entrypoint /bin/bash \
  -v /Users/dmatute/Documents/CAMRA/Scripts/Terra_Tool_Creation/GitHub/CAMRA/Workflows/cromwell-executions/assembly_analysis/e381edbe-d6a6-4db0-9006-12ea88de15f0/call-get_MLST_db:/cromwell-executions/assembly_analysis/e381edbe-d6a6-4db0-9006-12ea88de15f0/call-get_MLST_db:delegated \
  staphb/mlst@sha256:2ddfcba706573317a3e8395406334cd24fc469cd8d20cd6d5eeed717ea6c54af /cromwell-executions/assembly_analysis/e381edbe-d6a6-4db0-9006-12ea88de15f0/call-get_MLST_db/execution/script

# get the return code (working even if the container was detached)
rc=$(docker wait `cat /Users/dmatute/Documents/CAMRA/Scripts/Terra_Tool_Creation/GitHub/CAMRA/Workflows/cromwell-executions/assembly_analysis/e381edbe-d6a6-4db0-9006-12ea88de15f0/call-get_MLST_db/execution/docker_cid`)

# remove the container after waiting
docker rm `cat /Users/dmatute/Documents/CAMRA/Scripts/Terra_Tool_Creation/GitHub/CAMRA/Workflows/cromwell-executions/assembly_analysis/e381edbe-d6a6-4db0-9006-12ea88de15f0/call-get_MLST_db/execution/docker_cid`

# return exit code
exit $rc
